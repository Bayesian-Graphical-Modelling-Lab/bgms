---
output: github_document
bibliography: inst/REFERENCES.bib
csl: inst/apa.csl
---
  
```{r, echo = FALSE, message=F}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  dev = "png",
  dpi = 200,
  fig.align = "center",
  knitr::opts_chunk$set(comment = NA)
)
library(bgms)
```

<!-- badges: start -->
[![CRAN Version](https://www.r-pkg.org/badges/version/bgms)](https://cran.r-project.org/package=bgms)
[![Downloads](https://cranlogs.r-pkg.org/badges/bgms)](https://cran.r-project.org/package=bgms)
[![Total](https://cranlogs.r-pkg.org/badges/grand-total/bgms)](https://cran.r-project.org/package=bgms)
<!-- badges: end -->

# bgms: Bayesian Analysis of Networks of Binary and/or Ordinal Variables
  
<a href="https://bayesiangraphicalmodeling.com"><img src="inst/bgms_sticker.svg" height="200" align="right" /></a>

The **bgms** package implements Bayesian estimation and model comparison for
**ordinal Markov random fields (MRFs)**, graphical models that represent
networks of binary and/or ordinal variables [@MarsmanVandenBerghHaslbeck_2024].
The likelihood is approximated with a pseudolikelihood, and Markov chain Monte
Carlo (MCMC) methods are used to sample from the corresponding pseudoposterior
distribution of the model parameters.

## Main functions

The package has two main entry points:

- `bgm()` – estimates a single network in a one-sample design.  
- `bgmCompare()` – compares networks between groups in an independent-sample
  design [see @MarsmanWaldorpSekulovskiHaslbeck_2024].

## Effect selection

Both functions support **effect selection** with spike-and-slab priors:

- **Edges in one-sample designs**:  
  `bgm()` models the presence or absence of edges between variables. Posterior
  inclusion probabilities indicate the plausibility of each edge and can be
  converted into Bayes factors for conditional independence tests [see @MarsmanVandenBerghHaslbeck_2024, @SekulovskiEtAl_2024].

- **Communities/clusters in one-sample designs**:  
  `bgm()` can also model community structure. Posterior probabilities for the
  number of clusters quantify the plausibility of clustering solutions and can
  be converted into Bayes factors [see @SekulovskiEtAl_2025].

- **Group differences in independent-sample designs**:  
  `bgmCompare()` models differences in edge weights and category thresholds
  between groups. Posterior inclusion probabilities indicate the plausibility
  of parameter differences and can be converted into Bayes factors for tests of
  parameter equivalence [see MarsmanWaldorpSekulovskiHaslbeck_2024].
  
## Learn more

For worked examples and tutorials, see the package vignettes:

- [Getting Started](https://yourpkgdownsite/articles/intro.html)  
- [Model Comparison](https://yourpkgdownsite/articles/comparison.html)  
- [Diagnostics and Spike-and-Slab Summaries](https://yourpkgdownsite/articles/diagnostics.html)  

You can also access these directly from R with:

```{r}
browseVignettes("bgms")
```


## Why use Markov Random Fields?

Multivariate analysis using graphical models has received much attention in the recent psychological and psychometric literature [@RobinaughEtAl_2020; @MarsmanRhemtulla_2022_SIintro; @ContrerasEtAl_2019]. Most of these graphical models are Markov Random Field (MRF) models, whose graph structure reflects the partial associations between variables [@KindermannSnell1980]. In these models, a missing edge between two variables in the network implies that these variables are independent, given the remaining variables [@Lauritzen2004]. In other words, the remaining variables of the network fully account for the potential association between the unconnected variables.

## Why use a Bayesian approach to analyze the MRF?

Testing the structure of the MRF in a one-sample design requires us to determine the plausibility of the opposing hypotheses of conditional dependence and conditional independence. That is, how plausible is it that the observed data come from a network with a structure that includes the edge between two variables compared to a network structure that excludes that edge? Similarly, testing for group differences in the MRF in an independent-samples design requires us to determine the plausibility of the opposing hypotheses of parameter difference and parameter equivalence. That is, how plausible is it that the observed data come from MRFs with differences in specific edge weights or threshold parameters compared to MRFs that do not differ in these parameter?

Frequentist approaches are limited in this respect because they can only reject, not support, null hypotheses of conditional independence or parameter equivalence. This leads to the problem that if an edge is excluded, we do not know whether this is because the edge is absent in the population or because we do not have enough data to reject the null hypothesis of independence. Similarly, if a difference is excluded, we do not know whether this is because there is no difference in the parameter between the different groups or because we do not have enough data to reject the null hypothesis of parameter equivalence.

To avoid this problem, we will advocate a Bayesian approach using Bayes factors. In one-sample designs, the inclusion Bayes factor [@HuthEtAl_2023_intro; @SekulovskiEtAl_2024] allows us to quantify how much the data support both conditional dependence -<em>evidence of edge presence</em> - or conditional independence -<em>evidence of edge absence</em>. It also allows us to conclude that there is limited support for either hypothesis - an <em>absence of evidence</em>. In independent-sample designs, they can be used to quantify how much the data support the hypotheses of parameter difference and equivalence. The output of the <strong>bgm</strong> and <strong>bgmCompare</strong> functions can be used to estimate these inclusion Bayes factors.

## Installation

The current developmental version can be installed with	
```{r gh-installation, eval = FALSE}	
if (!requireNamespace("remotes")) {	
  install.packages("remotes")	
}	
remotes::install_github("Bayesian-Graphical-Modelling-Lab/bgms")
```


## References