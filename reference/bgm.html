<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function bgm explores the joint pseudoposterior distribution of
structures and parameters in a Markov Random Field for mixed binary and
ordinal variables."><title>Bayesian structure learning in Markov Random Fields of mixed binary and
ordinal variables using MCMC. — bgm • bgms</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.8/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian structure learning in Markov Random Fields of mixed binary and
ordinal variables using MCMC. — bgm"><meta property="og:description" content="The function bgm explores the joint pseudoposterior distribution of
structures and parameters in a Markov Random Field for mixed binary and
ordinal variables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bgms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introducing bgms</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MaartenMarsman/bgms/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bayesian structure learning in Markov Random Fields of mixed binary and
ordinal variables using MCMC.</h1>
      <small class="dont-index">Source: <a href="https://github.com/MaartenMarsman/bgms/blob/HEAD/R/bgm.R" class="external-link"><code>R/bgm.R</code></a></small>
      <div class="d-none name"><code>bgm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>bgm</code> explores the joint pseudoposterior distribution of
structures and parameters in a Markov Random Field for mixed binary and
ordinal variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bgm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  interaction_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cauchy"</span>, <span class="st">"UnitInfo"</span><span class="op">)</span>,</span>
<span>  cauchy_scale <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  edge_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bernoulli"</span>, <span class="st">"Beta-Bernoulli"</span><span class="op">)</span>,</span>
<span>  inclusion_probability <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  beta_bernoulli_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta_bernoulli_beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  threshold_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  threshold_beta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  adaptive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"listwise"</span>, <span class="st">"impute"</span><span class="op">)</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A data frame or matrix with <code>n</code> rows and <code>p</code> columns
containing binary and ordinal variables for <code>n</code> independent observations
and <code>p</code> variables in the network. Variables are recoded as non-negative
integers <code>(0, 1, ..., m)</code> if not already done. Unobserved categories are
collapsed into other categories after recoding (i.e., if category 1 is
unobserved, the data will be recoded from (0, 2) to (0, 1)).</p></dd>


<dt>iter</dt>
<dd><p>The number of iterations of the Gibbs sampler. The default of
<code>1e4</code> is for illustrative purposes. For stable estimates, it is
recommended to run the Gibbs sampler for at least <code>1e5</code> iterations.</p></dd>


<dt>burnin</dt>
<dd><p>The number of iterations of the Gibbs sampler before its output
is saved. Since it may take some time for the Gibbs sampler to converge to
the posterior distribution, it is recommended not to set this number too low.</p></dd>


<dt>interaction_prior</dt>
<dd><p>The type of prior distribution that is used for the
interaction effects. Currently, two prior densities are implemented: The
Cauchy prior (<code>interaction_prior = "Cauchy"</code>) and the Unit Information
prior (<code>interaction_prior = "UnitInfo"</code>).</p></dd>


<dt>cauchy_scale</dt>
<dd><p>The scale of the Cauchy prior for interactions. Defaults
to <code>2.5</code>.</p></dd>


<dt>edge_prior</dt>
<dd><p>The prior distribution for the edges or structure of the
network. Two prior distributions are currently implemented: The Bernoulli
model <code>edge_prior = "Bernoulli"</code> assumes that the probability that an
edge between two variables is included is equal to
<code>inclusion_probability</code> and independent of other edges or variables.
When <code>inclusion_probability = 0.5</code>, this implies that each network
structure receives the same prior weight. The Beta-Bernoulli model
<code>edge_prior = "Beta-Bernoulli"</code> assumes a beta prior for the unknown
inclusion probability with shape parameters <code>beta_bernoulli_alpha</code> and
<code>beta_bernoulli_beta</code>. If <code>beta_bernoulli_alpha = 1</code> and
<code>beta_bernoulli_beta = 1</code>, this means that networks with the same
complexity (number of edges) receive the same prior weight. Defaults to
<code>edge_prior = "Bernoulli"</code>.</p></dd>


<dt>inclusion_probability</dt>
<dd><p>The prior edge inclusion probability for the
Bernoulli model. Can be a single probability, or a matrix of <code>p</code> rows
and <code>p</code> columns specifying an inclusion probability for each edge pair.
Defaults to <code>inclusion_probability = 0.5</code>.</p></dd>


<dt>beta_bernoulli_alpha, beta_bernoulli_beta</dt>
<dd><p>The two shape parameters of
the Beta prior density for the Bernoulli inclusion probability. Must be
positive numbers. Defaults to <code>beta_bernoulli_alpha = 1</code> and
<code>beta_bernoulli_beta = 1</code>.</p></dd>


<dt>threshold_alpha, threshold_beta</dt>
<dd><p>The shape parameters of the beta-prime
prior density for the threshold parameters. Must be positive values. If the
two values are equal, the prior density is symmetric about zero. If
<code>threshold_beta</code> is greater than <code>threshold_alpha</code>, the
distribution is skewed to the left, and if <code>threshold_beta</code> is less than
<code>threshold_alpha</code>, it is skewed to the right. Smaller values tend to
lead to more diffuse prior distributions.</p></dd>


<dt>adaptive</dt>
<dd><p>Should the function use an adaptive Metropolis algorithm to
update interaction parameters within the model? If <code>adaptive = TRUE</code>,
bgm adjusts the proposal variance to match the acceptance probability of the
random walk Metropolis algorithm to be close to the optimum of <code>.234</code>
using a Robbins-Monro type algorithm. If <code>adaptive = FALSE</code>, it sets the
proposal variance to the inverse of the observed Fisher information matrix
(the second derivative at the posterior mode). Defaults to <code>FALSE</code>.</p></dd>


<dt>na.action</dt>
<dd><p>How do you want the function to handle missing data? If
<code>na.action = "listwise"</code>, listwise deletion is used. If
<code>na.action = "impute"</code>, missing data are imputed iteratively during the
MCMC procedure. Since imputation of missing data can have a negative impact
on the convergence speed of the MCMC procedure, it is recommended to run the
MCMC for more iterations. Also, since the numerical routines that search for
the mode of the posterior do not have an imputation option, the bgm function
will automatically switch to <code>interaction_prior = "Cauchy"</code> and
<code>adaptive = TRUE</code>.</p></dd>


<dt>save</dt>
<dd><p>Should the function collect and return all samples from the Gibbs
sampler (<code>save = TRUE</code>)? Or should it only return the (model-averaged)
posterior means (<code>save = FALSE</code>)? Defaults to <code>FALSE</code>.</p></dd>


<dt>display_progress</dt>
<dd><p>Should the function show a progress bar
(<code>display_progress = TRUE</code>)? Or not (<code>display_progress = FALSE</code>)?
Defaults to <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>save = FALSE</code> (the default), the result is a list of class
``bgms'' containing the following matrices:</p><ul><li><p><code>gamma</code>: A matrix with <code>p</code> rows and <code>p</code> columns,
containing posterior inclusion probabilities of individual edges.</p></li>
<li><p><code>interactions</code>: A matrix with <code>p</code> rows and <code>p</code> columns,
containing model-averaged posterior means of the pairwise associations.</p></li>
<li><p><code>thresholds</code>: A matrix with <code>p</code> rows and <code>max(m)</code>
columns, containing model-averaged category thresholds.</p></li>
</ul><p>If <code>save = TRUE</code>, the result is a list of class ``bgms'' containing:</p><ul><li><p><code>gamma</code>: A matrix with <code>iter</code> rows and
<code>p * (p - 1) / 2</code> columns, containing the edge inclusion indicators from
every iteration of the Gibbs sampler.</p></li>
<li><p><code>interactions</code>: A matrix with <code>iter</code> rows and
<code>p * (p - 1) / 2</code> columns, containing parameter states from every
iteration of the Gibbs sampler for the pairwise associations.</p></li>
<li><p><code>thresholds</code>: A matrix with <code>iter</code> rows and
<code>sum(m)</code> columns, containing parameter states from every iteration of
the Gibbs sampler for the category thresholds.</p></li>
</ul><p>Column averages of these matrices provide the model-averaged posterior means.</p>


<p>In addition to the analysis results, the bgm output lists some of the
arguments of its call. This is useful for post-processing the results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A discrete spike and slab prior distribution is stipulated on the pairwise
interactions. By formulating it as a mixture of mutually singular
distributions, the function can use a combination of Metropolis-Hastings and
Gibbs sampling to create a Markov chain that has the joint posterior
distribution as invariant. Current options for the slab distribution are the
unit-information prior or a Cauchy with an optional scaling parameter. A
Beta-prime distribution is used for the exponent of the category parameters.
A uniform prior is used for edge inclusion variables (i.e., the prior
probability that the edge is included is 0.5).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span> <span class="co">#Store user par() settings</span></span></span>
<span class="r-in"><span> <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">##Analyse the Wenchuan dataset</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Here, we use 1e4 iterations, for an actual analysis please use at least</span></span></span>
<span class="r-in"><span> <span class="co"># 1e5 iterations.</span></span></span>
<span class="r-in"><span> <span class="va">fit</span> <span class="op">=</span> <span class="fu">bgm</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Wenchuan</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 18 rows with missing observations in the input matrix x.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Since ``na.action = listwise'' these rows were excluded </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> from the analysis.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#------------------------------------------------------------------------------|</span></span></span>
<span class="r-in"><span> <span class="co"># INCLUSION - EDGE WEIGHT PLOT</span></span></span>
<span class="r-in"><span> <span class="co">#------------------------------------------------------------------------------|</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">interactions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">interactions</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      y <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span><span class="op">)</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"gray"</span>, cex <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">.5</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Posterior Mode Edge Weight"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Posterior Inclusion Probability"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bgm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#------------------------------------------------------------------------------|</span></span></span>
<span class="r-in"><span> <span class="co"># EVIDENCE - EDGE WEIGHT PLOT</span></span></span>
<span class="r-in"><span> <span class="co">#------------------------------------------------------------------------------|</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#The bgms package currently assumes that the prior odds are 1:</span></span></span>
<span class="r-in"><span> <span class="va">prior.odds</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span> <span class="va">posterior.inclusion</span> <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">gamma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">gamma</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">posterior.odds</span> <span class="op">=</span> <span class="va">posterior.inclusion</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">posterior.inclusion</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">log.bayesfactor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">posterior.odds</span> <span class="op">/</span> <span class="va">prior.odds</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">log.bayesfactor</span><span class="op">[</span><span class="va">log.bayesfactor</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">]</span> <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">interactions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">interactions</span><span class="op">)</span><span class="op">]</span>, <span class="va">log.bayesfactor</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"#bfbfbf"</span>,</span></span>
<span class="r-in"><span>      cex <span class="op">=</span> <span class="fl">1.3</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"#bfbfbf"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"#bfbfbf"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Evidence for Exclusion"</span>, pos <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>      cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, labels <span class="op">=</span> <span class="st">"Evidence for Inclusion"</span>, pos <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">0</span>, labels <span class="op">=</span> <span class="st">"Absence of Evidence"</span>, cex <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Log-Inclusion Bayes Factor"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, las <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Posterior Mean Interactions "</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3.7</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, las <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#------------------------------------------------------------------------------|</span></span></span>
<span class="r-in"><span> <span class="co"># THE LOCAL MEDIAN PROBABILITY NETWORK</span></span></span>
<span class="r-in"><span> <span class="co">#------------------------------------------------------------------------------|</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">tmp</span> <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">interactions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">interactions</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">tmp</span><span class="op">[</span><span class="va">posterior.inclusion</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">median.prob.model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Wenchuan</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Wenchuan</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">median.prob.model</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">median.prob.model</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="va">tmp</span></span></span>
<span class="r-in"><span> <span class="va">median.prob.model</span> <span class="op">=</span> <span class="va">median.prob.model</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">median.prob.model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">median.prob.model</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Wenchuan</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">median.prob.model</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Wenchuan</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bgm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html" class="external-link">qgraph</a></span><span class="op">(</span><span class="va">median.prob.model</span>,</span></span>
<span class="r-in"><span>        theme <span class="op">=</span> <span class="st">"TeamFortress"</span>,</span></span>
<span class="r-in"><span>        maximum <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span>        fade <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f0ae0e"</span><span class="op">)</span>, vsize <span class="op">=</span> <span class="fl">10</span>, repulsion <span class="op">=</span> <span class="fl">.9</span>,</span></span>
<span class="r-in"><span>        label.cex <span class="op">=</span> <span class="fl">1.1</span>, label.scale <span class="op">=</span> <span class="st">"FALSE"</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Wenchuan</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bgm-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#Restore user par() settings</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p><p>Developed by Maarten Marsman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer></body></html>

