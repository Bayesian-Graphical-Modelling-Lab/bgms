<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Maarten Marsman" />


<title>Spike-and-Slab Posterior Diagnostics</title>

<script src="spike_slab_manual_files/header-attrs-2.29/header-attrs.js"></script>
<script src="spike_slab_manual_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="spike_slab_manual_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="spike_slab_manual_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="spike_slab_manual_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="spike_slab_manual_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="spike_slab_manual_files/navigation-1.1/tabsets.js"></script>
<link href="spike_slab_manual_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="spike_slab_manual_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Spike-and-Slab Posterior Diagnostics</h1>
<h4 class="author">Maarten Marsman</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#spike-and-slab-mcmc-summary-diagnostics"
id="toc-spike-and-slab-mcmc-summary-diagnostics"><span
class="toc-section-number">1</span> Spike-and-Slab MCMC Summary
Diagnostics</a>
<ul>
<li><a href="#overview" id="toc-overview"><span
class="toc-section-number">1.1</span> Overview</a></li>
<li><a href="#summary-functions" id="toc-summary-functions"><span
class="toc-section-number">1.2</span> Summary Functions</a>
<ul>
<li><a href="#summarize_manual" id="toc-summarize_manual"><span
class="toc-section-number">1.2.1</span>
<code>summarize_manual()</code></a></li>
<li><a href="#summarize_indicator" id="toc-summarize_indicator"><span
class="toc-section-number">1.2.2</span>
<code>summarize_indicator()</code></a></li>
<li><a href="#summarize_slab" id="toc-summarize_slab"><span
class="toc-section-number">1.2.3</span>
<code>summarize_slab()</code></a></li>
<li><a href="#summarize_pair" id="toc-summarize_pair"><span
class="toc-section-number">1.2.4</span> 2.4
<code>summarize_pair()</code></a></li>
</ul></li>
<li><a href="#unified-summary-summarize_fit"
id="toc-unified-summary-summarize_fit"><span
class="toc-section-number">1.3</span> Unified Summary:
<code>summarize_fit()</code></a></li>
<li><a href="#error-handling-and-robustness"
id="toc-error-handling-and-robustness"><span
class="toc-section-number">1.4</span> Error Handling and
Robustness</a></li>
<li><a href="#output-format" id="toc-output-format"><span
class="toc-section-number">1.5</span> 5. Output Format</a></li>
<li><a href="#implementation-details"
id="toc-implementation-details"><span
class="toc-section-number">1.6</span> 6. Implementation Details</a></li>
</ul></li>
</ul>
</div>

<div id="spike-and-slab-mcmc-summary-diagnostics" class="section level1"
number="1">
<h1><span class="header-section-number">1</span> Spike-and-Slab MCMC
Summary Diagnostics</h1>
<p>This document describes the summary statistics and convergence
diagnostics computed for Bayesian spike-and-slab models implemented in
<code>bgms</code>. It is structured in a way to support both applied
users and methods researchers who want full reproducibility. The design
and reporting logic draws inspiration from the Stan reference
manual.</p>
<hr />
<div id="overview" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Overview</h2>
<p>We consider two scenarios:</p>
<ul>
<li><strong>No selection model</strong>: All parameters are always
included.</li>
<li><strong>Selection model</strong>: Parameters are governed by binary
inclusion indicators (e.g., spike-and-slab prior).</li>
</ul>
<p>In both cases, MCMC is used to sample from the posterior
distribution, potentially with multiple chains. The <code>bgm</code>
sampler, for example, produces samples for:</p>
<ul>
<li><code>main_samples</code>: main effects (always continuous)</li>
<li><code>pairwise_samples</code>: pairwise interactions (continuous,
may include exact 0s when selection is enabled)</li>
<li><code>indicator_samples</code>: binary indicators for pairwise
effects (only present if selection is enabled)</li>
</ul>
<hr />
</div>
<div id="summary-functions" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Summary
Functions</h2>
<p>We compute summaries for each parameter using modular R functions.
Below we describe their purpose and methodology.</p>
<div id="summarize_manual" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span>
<code>summarize_manual()</code></h3>
<p><strong>Applies to</strong>: <code>main_samples</code> or
<code>pairwise_samples</code> in the selection disabled <code>bgm</code>
model.</p>
<p><strong>Statistics reported</strong>:</p>
<ul>
<li>Posterior mean</li>
<li>Posterior standard deviation</li>
<li>Monte Carlo standard error (MCSE): <span class="math inline">\(sd /
\sqrt(\text{n}_\text{eff})\)</span></li>
<li>Effective sample size <span
class="math inline">\(\text{n}_\text{eff}\)</span> using
autocorrelation-adjusted estimates</li>
<li>Gelman-Rubin R-hat across chains (if &gt;1 chain)</li>
</ul>
<p><strong>Method</strong>:</p>
<ul>
<li>Combines all chains into a 3D array
<code>iterations x chains x parameters</code></li>
<li>Computes marginal summaries per parameter</li>
<li>Uses <code>coda::effectiveSize()</code> and
<code>coda::gelman.diag()</code></li>
</ul>
<hr />
</div>
<div id="summarize_indicator" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span>
<code>summarize_indicator()</code></h3>
<p><strong>Applies to</strong>: <code>indicator_samples</code></p>
<p><strong>Statistics reported</strong>:</p>
<ul>
<li>Mean inclusion probability</li>
<li>Standard deviation</li>
<li>MCSE via Markov 2-state chain estimate</li>
<li>Transition counts: <span class="math inline">\(0 \rightarrow
0\)</span>, <span class="math inline">\(0 \rightarrow 1\)</span>, <span
class="math inline">\(1 \rightarrow 0\)</span>, <span
class="math inline">\(1 \rightarrow 1\)</span></li>
<li>Effective sample size from autocorrelation time of 2-state Markov
model</li>
<li>R-hat across chains</li>
</ul>
<p><strong>Method</strong>:</p>
<ul>
<li>Treats inclusion indicators as binary time series</li>
<li>Estimates transition probabilities <span class="math inline">\(a =
\text{n}_{0 \rightarrow 1}\)</span>, <span class="math inline">\(b =
\text{n}_{1 \rightarrow 0}\)</span></li>
<li>Computes integrated autocorrelation time: <span
class="math inline">\(\tau = \frac{2 - a - b}{a + b}\)</span></li>
<li>Effective sample size: <span
class="math inline">\(\text{n}_{\text{eff}} = \frac{T}{\tau}\)</span>,
with <span class="math inline">\(T\)</span> total sample size</li>
<li>Estimates MCSE: <span class="math inline">\(\text{sd} /
\sqrt{\text{n}_{\text{eff}}}\)</span></li>
</ul>
<hr />
</div>
<div id="summarize_slab" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span>
<code>summarize_slab()</code></h3>
<p><strong>Applies to</strong>: <code>pairwise_samples</code>, where
values are sometimes 0 due to exclusion</p>
<p><strong>Statistics reported</strong>:</p>
<ul>
<li>Conditional mean given inclusion (i.e., non-zero samples)</li>
<li>Standard deviation of non-zero values</li>
<li>MCSE using standard ESS</li>
<li>Number of non-zero samples</li>
<li>Effective sample size (ESS)</li>
<li>R-hat across chains (computed on non-zero draws)</li>
</ul>
<p><strong>Method</strong>: - Extracts non-zero draws per parameter -
Uses standard Monte Carlo diagnostics as in
<code>summarize_manual()</code></p>
<hr />
</div>
<div id="summarize_pair" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> 2.4
<code>summarize_pair()</code></h3>
<p><strong>Applies to</strong>: Combination of
<code>indicator_samples</code> and <code>pairwise_samples</code></p>
<p><strong>Statistics reported</strong>:</p>
<ul>
<li>Posterior mean: <span class="math inline">\(\mathbb{E}(\theta) =
\mathbb{E}(\theta \mid \gamma = 1) \cdot \hat{P}(\gamma =
1)\)</span></li>
<li>Posterior standard deviation using delta method</li>
<li>MCSE via variance propagation</li>
<li>Combined effective sample size</li>
<li>R-hat via mixed variance decomposition</li>
</ul>
<p><strong>Method</strong>:</p>
<ul>
<li>Combines slab mean and inclusion probability</li>
<li>Uses delta method to propagate uncertainty: <span
class="math inline">\(\text{Var}(\hat{\mu}_1, \hat{\mu}_2) \approx
\mu_2^2 \cdot \text{Var}(\hat{\mu}_1) + \mu_1^2 \cdot
\text{Var}(\hat{\mu}_2)\)</span></li>
<li>Effective sample size: <span class="math inline">\(\text{ESS} =
\frac{\text{Var}}{\text{MCSE}^2}\)</span></li>
<li>R-hat combines between-chain and within-chain variance over mixture
means</li>
</ul>
<hr />
</div>
</div>
<div id="unified-summary-summarize_fit" class="section level2"
number="1.3">
<h2><span class="header-section-number">1.3</span> Unified Summary:
<code>summarize_fit()</code></h2>
<p>This function detects whether edge selection is in use
(<code>edge_selection = TRUE/FALSE</code>) and routes components
accordingly:</p>
<ul>
<li>Always uses <code>summarize_manual()</code> for main effects</li>
<li>For pairwise effects:
<ul>
<li>If no selection: uses <code>summarize_manual()</code></li>
<li>If selection:
<ul>
<li>If all indicators are 1 for a given parameter: fallback to
<code>summarize_manual()</code></li>
<li>Else: use <code>summarize_pair()</code> per parameter</li>
</ul></li>
</ul></li>
</ul>
<p>The result is a named list:</p>
<pre class="r"><code>list(
  main = &lt;summary table&gt;,
  pairwise = &lt;summary table&gt;
)</code></pre>
<hr />
</div>
<div id="error-handling-and-robustness" class="section level2"
number="1.4">
<h2><span class="header-section-number">1.4</span> Error Handling and
Robustness</h2>
<ul>
<li>All diagnostic steps use <code>tryCatch()</code> to return
<code>NA</code> on failure</li>
<li>Chains with fewer than 3 non-zero values are excluded from R-hat
computation</li>
<li>Transition-based ESS is used for binary indicators</li>
<li>Combined MCSEs and ESSs are computed using propagated variance
estimates</li>
</ul>
<hr />
</div>
<div id="output-format" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> 5. Output Format</h2>
<p>All summary functions return <code>data.frame</code> objects with
fixed columns. Parameters are labeled using <code>parameter</code> or
variable names when available.</p>
<hr />
</div>
<div id="implementation-details" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> 6. Implementation
Details</h2>
<ul>
<li>Written in R, using <code>coda</code> for ESS and R-hat
diagnostics</li>
<li>Chains assumed to be of equal length and aligned across
parameters</li>
<li>Optional integration with Quarto or LaTeX for reporting</li>
</ul>
<hr />
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "spike_slab_manual_files/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
