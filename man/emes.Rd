% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/emes.R
\name{emes}
\alias{emes}
\title{EM edge selection for a Markov Random Field model for ordinal variables.}
\usage{
emes(
  x,
  no_categories,
  precision = 0.975,
  convergence_criterion = sqrt(.Machine$double.eps),
  theta = 0.5,
  hierarchical = FALSE,
  alpha = 1,
  beta = 1,
  maximum_iterations = 1000,
  threshold_prior_var = 1
)
}
\arguments{
\item{x}{An \code{no_persons} by \code{no_nodes} matrix containing the 
categories coded as non-negative integers (i.e., coded 
\code{0, 1, ..., no_categories}) for \code{no_persons} independent 
observations on \code{no_nodes} variables in the network or graph.}

\item{no_categories}{The maximum category.}

\item{precision}{A number between zero and one. The prior precision that is
desired for edge selection. Equal to one minus the desired type-1 error.
Defaults to \code{.975}.}

\item{convergence_criterion}{The convergence criterion for the 
pseudoposterior values in the EM algorithm. Defaults to 
\code{sqrt(.Machine$double.eps)}.}

\item{theta}{The prior inclusion probability. The value \code{theta = 0.5},
in combination with \code{hierarchical = FALSE} stipulates a uniform prior
on the space of network structures.}

\item{hierarchical}{Logical. If TRUE, a beta prior distribution is
imposed on the prior inclusion probability \code{theta} with
hyperparameters \code{alpha} and \code{beta}. A uniform prior on the
inclusion probability, a beta with \code{alpha = beta = 1}, stipulates a
uniform prior on network structure complexity.}

\item{alpha, beta}{The hyperparameters of the beta prior distribution
stipulated on the prior inclusion probability \code{theta} if
\code{hierarchical = TRUE}. Default to \code{1}.}

\item{maximum_iterations}{The maximum number of EM iterations used. Defaults 
to \code{1e3}. A warning is issued if procedure has not converged in 
\code{maximum_iterations} iterations.}

\item{threshold_prior_var}{The variance that is used in the normal prior 
density stipulated on the threshold parameters. Currently a normal
distribution is used for all threshold parameters, with a mean equal to
zero and a variance equal to \code{threshold_prior_var}. Defaults to
\code{1}.}
}
\value{
A list containing the \code{no_nodes} by \code{no_nodes} matrices 
 \code{interactions} and \code{gamma}, the \code{no_nodes} by 
 \code{no_categories} matrix \code{thresholds}, and, if 
 \code{hierarchical == TRUE}, a numeric valued \code{theta}. The matrix 
 \code{interactions} is a numeric matrix with pairwise
  association estimates on the off-diagonal elements. The matrix \code{gamma} 
  contains the expected values of edge inclusion variables (i.e., the local 
  posterior probability of edge inclusion. The matrix \code{thresholds} 
  contains the category thresholds per node. If \code{hierarchical = TRUE}, 
  the modal estimate of the prior inclusion probability \code{theta} is also 
  provided.
}
\description{
The function \code{emes} selects promising edges for the ordinal 
MRF using the joint pseudolikelihood and a continuous spike and slab prior 
distribution stipulated on the MRF's interaction or association parameters.
}
