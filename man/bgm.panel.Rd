% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bgm.panel.R
\name{bgm.panel}
\alias{bgm.panel}
\title{Bayesian structure learning in a cross-lagged Markov Random Field model for
mixed binary and ordinal variables using MCMC.}
\usage{
bgm.panel(
  x,
  no_nodes,
  no_timepoints,
  iter = 10000,
  burnin = 1000,
  cauchy_scale = 2.5,
  cross_sectional_edge_prior = "Bernoulli",
  cross_lagged_edge_prior = "Bernoulli",
  cross_sectional_inclusion_probability = 0.5,
  cross_lagged_inclusion_probability = 0.5,
  cross_sectional_beta_bernoulli_alpha = 1,
  cross_sectional_beta_bernoulli_beta = 1,
  cross_lagged_beta_bernoulli_alpha = 1,
  cross_lagged_beta_bernoulli_beta = 1,
  threshold_alpha = 1,
  threshold_beta = 1,
  save = FALSE,
  display_progress = TRUE
)
}
\arguments{
\item{x}{A data frame or matrix with \code{n} rows and \code{p} times \code{t}
columns containing binary and ordinal variables for \code{n} independent
observations and \code{p} variables in \code{t} measurement occasions.
Variables are recoded as non-negative integers \code{(0, 1, ..., m)} if not
already done. Unobserved categories are collapsed into other categories after
recoding (i.e., if category 1 is unobserved, the data will be recoded from
(0, 2) to (0, 1)).}

\item{no_nodes}{The number of nodes per timepoint.}

\item{no_timepoints}{The number of timepoints. Must be a positive number.
Does not include time t = 0.}

\item{iter}{The number of iterations of the Gibbs sampler. The default of
\code{1e4} is for illustrative purposes. For stable estimates, it is
recommended to run the Gibbs sampler for at least \code{1e5} iterations.}

\item{burnin}{The number of iterations of the Gibbs sampler before its output
is saved. Since it may take some time for the Gibbs sampler to converge to
the posterior distribution, it is recommended not to set this number too low.}

\item{cauchy_scale}{The scale of the Cauchy prior for interactions. Defaults
to \code{2.5}.}

\item{cross_sectional_edge_prior, cross_lagged_edge_prior}{The prior
distribution for the cross_lagged edges of the panel network. Currently, two
prior distributions are implemented: The Bernoulli model
\code{edge_prior = "Bernoulli"} assumes that the probability that an edge
between two variables is included is equal to \code{inclusion_probability}
and independent of other edges or variables. When
\code{inclusion_probability = 0.5}, this implies that each network structure
receives the same prior weight. The Beta-Bernoulli model
\code{edge_prior = "Beta-Bernoulli"} assumes a beta prior for the unknown
inclusion probability with shape parameters \code{beta_bernoulli_alpha} and
\code{beta_bernoulli_beta}. If \code{beta_bernoulli_alpha = 1} and
\code{beta_bernoulli_beta = 1}, this means that networks with the same
complexity (number of edges) get the same prior weight. Defaults to
\code{cross_sectional_edge_prior = "Bernoulli"} and
\code{cross_lagged_edge_prior = "Bernoulli"}.}

\item{cross_sectional_inclusion_probability, cross_lagged_inclusion_probability}{The prior edge inclusion probability for the Bernoulli model. Can be a single
probability, or a matrix of \code{p} rows and \code{p} columns specifying an
inclusion probability for each edge pair. Defaults to
\code{cross_sectional_inclusion_probability = 0.5} and
\code{cross_lagged_inclusion_probability = 0.5}.}

\item{cross_sectional_beta_bernoulli_alpha, cross_sectional_beta_bernoulli_beta, cross_lagged_beta_bernoulli_alpha, cross_lagged_beta_bernoulli_beta}{The two shape parameters of the Beta prior density for the Bernoulli
inclusion probability. Must be positive numbers. Defaults to
\code{cross_sectional_beta_bernoulli_alpha = 1},
\code{cross_sectional_beta_bernoulli_beta = 1},
\code{cross_lagged_beta_bernoulli_alpha = 1}, and
\code{cross_lagged_beta_bernoulli_beta = 1}.}

\item{threshold_alpha, threshold_beta}{The shape parameters of the beta-prime
prior density for the threshold parameters. Must be positive values. If the
two values are equal, the prior density is symmetric about zero. If
\code{threshold_beta} is greater than \code{threshold_alpha}, the
distribution is skewed to the left, and if \code{threshold_beta} is less than
\code{threshold_alpha}, it is skewed to the right. Smaller values tend to
lead to more diffuse prior distributions.}

\item{save}{Should the function collect and return all samples from the Gibbs
sampler (\code{save = TRUE})? Or should it only return the (model-averaged)
posterior means (\code{save = FALSE})? Defaults to \code{FALSE}.}

\item{display_progress}{Should the function show a progress bar
(\code{display_progress = TRUE})? Or not (\code{display_progress = FALSE})?
Defaults to \code{TRUE}.}
}
\value{
If \code{save = FALSE} (the default), the result is a list containing
the following matrices:
\itemize{
\item \code{gamma}: A symmetric matrix with \code{p} rows and \code{p} columns,
containing posterior inclusion probabilities of cross-sectional edges.
\item \code{delta}: A matrix with \code{p} rows and \code{p} columns,
containing posterior inclusion probabilities of cross-lagged edges.
\item \code{cross_sectional_interactions}: A matrix with \code{p} rows and
\code{p} columns, containing model-averaged posterior means of the pairwise
cross-sectional associations.
\item \code{cross_lagged_interactions}: A matrix with \code{p} rows and
\code{p} columns, containing model-averaged posterior means of the pairwise
cross-lagged associations.
\item \code{thresholds}: A matrix with \code{p * t} rows and \code{max(m)}
columns, containing model-averaged category thresholds.
}

If \code{save = TRUE}, the result is a list containing:
\itemize{
\item \code{samples.gamma}: A matrix with \code{iter} rows and
\code{p * (p - 1) / 2} columns, containing the cross-sectional edge inclusion
indicators from every iteration of the Gibbs sampler.
\item \code{samples.delta}: A matrix with \code{iter} rows and \code{p * p}
columns, containing the cross-lagged edge inclusion indicators from every
iteration of the Gibbs sampler.
\item \code{samples.cross.sectional.interactions}: A matrix with \code{iter}
rows and \code{p * (p - 1) / 2} columns, containing parameter states from
every iteration of the Gibbs sampler for the pairwise cross-sectional
associations.
\item \code{samples.cross.lagged.interactions}: A matrix with \code{iter}
rows and \code{p * p} columns, containing parameter states from every
iteration of the Gibbs sampler for the pairwise cross-lagged associations.
\item \code{samples.thresholds}: A matrix with \code{iter} rows and
\code{sum(m) * t} columns, containing parameter states from every iteration of
the Gibbs sampler for the category thresholds.
}
Column averages of these matrices provide the model-averaged posterior means.
}
\description{
The function \code{bgm.panel} explores the joint pseudoposterior distribution
of structures and parameters in a cross-lagged Markov Random Field model for
mixed binary and ordinal variables, which can be used to analyze mixed binary
and ordinal panel data.
}
\details{
A discrete spike and slab prior distribution is stipulated on the pairwise
cross-sectional and cross-lagged interactions. By formulating it as a mixture
of mutually singular distributions, the function can use a combination of
Metropolis-Hastings and Gibbs sampling to create a Markov chain that has the
joint posterior distribution as invariant.
}
