% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est_bgm.R
\name{est_bgm}
\alias{est_bgm}
\title{Bayesian estimation of a Markov Random Field of mixed binary and ordinal
variables using MCMC.}
\usage{
est_bgm(
  x,
  iter = 10000,
  burnin = 1000,
  interaction_prior = c("Cauchy", "UnitInfo"),
  cauchy_scale = 2.5,
  threshold_alpha = 0.5,
  threshold_beta = 0.5,
  adaptive = FALSE,
  na.action = c("listwise", "impute"),
  save = FALSE,
  display_progress = TRUE
)
}
\arguments{
\item{x}{A data frame or matrix with \code{n} rows and \code{p} columns
containing binary and ordinal variables for \code{n} independent observations
and \code{p} variables in the network. Variables are recoded as non-negative
integers \code{(0, 1, ..., m)} if not already done. Unobserved categories are
collapsed into other categories after recoding (i.e., if category 1 is
unobserved, the data will be recoded from (0, 2) to (0, 1)).}

\item{iter}{The number of iterations of the Gibbs sampler. The default of
\code{1e4} is for illustrative purposes. For stable estimates, it is
recommended to run the Gibbs sampler for at least \code{1e5} iterations.}

\item{burnin}{The number of iterations of the Gibbs sampler before its output
is saved. Since it may take some time for the Gibbs sampler to converge to
the posterior distribution, it is recommended not to set this number too low.}

\item{interaction_prior}{The type of prior distribution that is used for the
interaction effects. Currently, two prior densities are implemented: The
Cauchy prior (\code{interaction_prior = "Cauchy"}) and the Unit Information
prior (\code{interaction_prior = "UnitInfo"}).}

\item{cauchy_scale}{The scale of the Cauchy prior for interactions. Defaults
to \code{2.5}.}

\item{threshold_alpha, threshold_beta}{The shape parameters of the beta-prime
prior density for the threshold parameters. Must be positive values. If the
two values are equal, the prior density is symmetric about zero. If
\code{threshold_beta} is greater than \code{threshold_alpha}, the
distribution is skewed to the left, and if \code{threshold_beta} is less than
\code{threshold_alpha}, it is skewed to the right. Smaller values tend to
lead to more diffuse prior distributions.}

\item{adaptive}{Should the function use an adaptive Metropolis algorithm to
update interaction parameters within the model? If \code{adaptive = TRUE},
bgm adjusts the proposal variance to match the acceptance probability of the
random walk Metropolis algorithm to be close to the optimum of \code{.234}
using a Robbins-Monro type algorithm. If \code{adaptive = FALSE}, it sets the
proposal variance to the inverse of the observed Fisher information matrix
(the second derivative at the posterior mode). Defaults to \code{FALSE}.}

\item{na.action}{How do you want the function to handle missing data? If
\code{na.action = "listwise"}, listwise deletion is used. If
\code{na.action = "impute"}, missing data are imputed iteratively during the
MCMC procedure. Since imputation of missing data can have a negative impact
on the convergence speed of the MCMC procedure, it is recommended to run the
MCMC for more iterations. Also, since the numerical routines that search for
the mode of the posterior do not have an imputation option, the bgm function
will automatically switch to \code{interaction_prior = "Cauchy"} and
\code{adaptive = TRUE}.}

\item{save}{Should the function collect and return all samples from the Gibbs
sampler (\code{save = TRUE})? Or should it only return the (model-averaged)
posterior means (\code{save = FALSE})? Defaults to \code{FALSE}.}

\item{display_progress}{Should the function show a progress bar
(\code{display_progress = TRUE})? Or not (\code{display_progress = FALSE})?
Defaults to \code{TRUE}.}
}
\value{
If \code{save = FALSE} (the default), the result is a list of class
``bgms'' containing the following matrices:
\itemize{
\item \code{interactions}: A matrix with \code{p} rows and \code{p} columns,
containing model-averaged posterior means of the pairwise associations.
\item \code{thresholds}: A matrix with \code{p} rows and \code{max(m)}
columns, containing model-averaged category thresholds.
}

If \code{save = TRUE}, the result is a list of class ``bgms'' containing:
\itemize{
\item \code{interactions}: A matrix with \code{iter} rows and
\code{p * (p - 1) / 2} columns, containing parameter states from every
iteration of the Gibbs sampler for the pairwise associations.
\item \code{thresholds}: A matrix with \code{iter} rows and
\code{sum(m)} columns, containing parameter states from every iteration of
the Gibbs sampler for the category thresholds.
}
Column averages of these matrices provide the model-averaged posterior means.

In addition to the analysis results, the bgm output lists some of the
arguments of its call. This is useful for post-processing the results.
}
\description{
The function \code{est_bgm} explores the joint posterior distribution
of the parameters of a Markov Random Field for mixed binary and ordinal
variables. It uses a combination of Metropolis-Hastings and Gibbs sampling to
create a Markov chain that has the posterior distribution as its invariant
distribution. The function uses a pseudolikelihood approach to circumvent
having to compute the intractable normalizing constant of the Markov Random
Field.
}
\details{
The prior distribution for the interactions is a Cauchy or Unit-Info type
prior. A Beta-prime distribution is used for the exponent of the category
parameters.
}
