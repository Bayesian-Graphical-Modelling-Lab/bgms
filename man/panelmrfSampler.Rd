% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sample_panel_MRF.R
\name{panelmrfSampler}
\alias{panelmrfSampler}
\title{Sample states of an ordinal cross-lagged panel MRF}
\usage{
panelmrfSampler(
  no_states,
  no_nodes,
  no_timepoints,
  no_categories,
  cross_sectional_interactions,
  cross_lagged_interactions,
  thresholds,
  null_interactions,
  null_thresholds,
  iter = 1000
)
}
\arguments{
\item{no_states}{The number of states of the ordinal cross-lagged panel MRF
to be generated. Must be a positive integer.}

\item{no_nodes}{The number of nodes in the ordinal cross-lagged panel MRF.
Must be an integer greater than or equal to two.}

\item{no_timepoints}{The number of timepoints in the ordinal cross-lagged
panel MRF. Must be a positive integer. The sampler also generates a vector of
responses for time \code{t = 0}, which are conditioned on at time \code{t = 1}.}

\item{no_categories}{Either a positive integer or a vector of positive
integers of length \code{no_nodes}. The number of response categories on top
of the base category: \code{no_categories = 1} generates binary states.}

\item{cross_sectional_interactions}{A symmetric \code{no_nodes} by
\code{no_nodes} matrix of pairwise cross-sectional interactions. Only its
off-diagonal elements are used.}

\item{cross_lagged_interactions}{A \code{no_nodes} by \code{no_nodes} matrix
of pairwise cross-lagged interactions.}

\item{thresholds}{A \code{no_nodes * no_timepoints} by
\code{max(no_categories)} matrix of category thresholds. The first
\code{no_nodes} rows correspond to the thresholds at time \code{t = 1}, the
second \code{no_nodes} rows correspond to the thresholds at time \code{t = 2},
etc. If \code{no_categories} is a vector, only the first
\code{no_categories[r]} elements are used in row \code{r}.}

\item{null_interactions}{A \code{no_nodes} by \code{no_nodes} matrix
of pairwise interactions used to generate observations at time \code{t = 0}.}

\item{null_thresholds}{A \code{no_nodes} by \code{max(no_categories)} matrix
of category thresholds used to generate observations at time \code{t = 0}. If
\code{no_categories} is a vector, only the first \code{no_categories[r]}
elements are used in row \code{r}.}

\item{iter}{The number of iterations used by the Gibbs sampler.
The function provides the last state of the Gibbs sampler as output. By
default set to \code{1e3}.}
}
\value{
A \code{no_states} by \code{no_nodes * (no_timepoints + 1)} matrix of
simulated states of the ordinal cross-lagged panel MRF. The first
\code{no_nodes} columns correspond to the observations at time \code{t = 0},
the second \code{no_nodes} columns to the observations at time \code{t = 1},
etc.
}
\description{
This function samples states from the ordinal cross-lagged panel MRF using a
Gibbs sampler. The Gibbs sampler is initiated with random values from the
response options, after which it proceeds by simulating states for each node
from a logistic model using the other node states as predictor variables.
}
\examples{
# Generate responses from a network of five ordinal variables on five timepoints.
no_states = 1000
no_nodes = 5
no_timepoints = 5
no_categories = 2

u = runif(no_nodes, min = -.5, max = 1)
cross_sectional_interactions = .1 * u \%*\% t(u)
u = runif(no_nodes, min = -.5, max = 1)
cross_lagged_interactions = u \%*\% t(u)
thresholds = matrix(-abs(rnorm(no_timepoints * no_nodes * no_categories, 2)),
  nrow = no_timepoints * no_nodes, ncol = no_categories)

null_interactions = 2 * cross_sectional_interactions
null_thresholds = thresholds[1:no_nodes, ]
x = panelmrfSampler (no_states = no_states,
  no_nodes = no_nodes,
  no_timepoints = no_timepoints,
  no_categories,
  cross_sectional_interactions,
  cross_lagged_interactions,
  thresholds,
  null_interactions,
  null_thresholds,
  iter = 1e4)
}
